mod base64_embedding;
mod css_injection;
mod dangerous_animation;
mod external_resource;
mod foreign_object;
mod id_reuse;
mod inline_event_handler;
mod javascript_obfuscation;
mod malicious_link;
mod script_tag;

pub use base64_embedding::Base64EmbeddingRule;
pub use css_injection::CssInjectionRule;
pub use dangerous_animation::DangerousAnimationRule;
pub use external_resource::ExternalResourceRule;
pub use foreign_object::ForeignObjectRule;
pub use id_reuse::IdReuseRule;
pub use inline_event_handler::InlineEventHandlerRule;
pub use javascript_obfuscation::JavaScriptObfuscationRule;
pub use malicious_link::MaliciousLinkRule;
pub use script_tag::ScriptTagRule;

use crate::svg_checker::SvgCheckError;
use async_trait::async_trait;
use quick_xml::Reader;

#[async_trait]
pub trait ExploitRule {
    async fn check_event(
        &self,
        e: &quick_xml::events::BytesStart<'_>,
        reader: &Reader<&[u8]>,
    ) -> Result<(), SvgCheckError>;
}
