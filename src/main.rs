mod svg_checker;
mod rules;

use std::path::PathBuf;
use svg_checker::{SvgChecker, SvgCheckError};

#[tokio::main]
async fn main() -> Result<(), SvgCheckError> {
    let checker = SvgChecker::new();
    match checker.check_file(PathBuf::from("exploit_test.svg")).await {
        Ok(_) => println!("No exploit detected"),
        Err(SvgCheckError::ExploitDetected(msg)) => println!("Exploit detected: {}", msg),
        Err(e) => println!("Error: {}", e),
    }
    Ok(())
}
